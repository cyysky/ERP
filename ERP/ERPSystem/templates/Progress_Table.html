<!DOCTYPE html>
    {% include 'we.html' %}
    {% block title %}{% endblock %}
    {% block content %}
    {% if user.is_authenticated %}
    {% else %}
    {% include 'home.html' %} <!-- 登录和注册 -->
    {% endif %}
    {% endblock %}
    {% if user.is_authenticated %}
<html lang="en">
{% include 'Master.html' %}<!-- Navs/导航 -->
{% include 'gg.html' %}
<head>
    <meta charset="UTF-8">
    <title>Employee Records</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/testing.css' %}" />
    <link rel="stylesheet" href="{% static 'css/13.css' %}" />
</head>
<body>
    <h1 class="nav-link p-3 bg-primary text-white">Progress Table(进程表)</h1>
    <div style="float:left;width:1800px">
        <form methon="get">
            <div class="input-group">
                <input type="text" name="search_sales_order" class="form-control" placeholder="Search for SalesOrderID" value="{{ search_data_sales_order }}">
                <input type="text" name="search_project" class="form-control" placeholder="Search for ProjectSalesItemID" value="{{ search_data_project }}">
                <input type="text" name="search_product" class="form-control" placeholder="Search for ProductID" value="{{ search_data_product }}">
                <input type="text" name="search_process" class="form-control" placeholder="Search for Process/ProductID" value="{{ search_data_process }}">
                <input type="text" name="search_material" class="form-control" placeholder="Search for MaterialID" value="{{ search_data_material }}">
                <input type="text" name="search_require" class="form-control" placeholder="Search for Require/ProductID" value="{{ search_data_require }}">
                <input type="text" name="search_purchase" class="form-control" placeholder="Search for Purchase/ProductID" value="{{ search_data_purchase }}">
                <span class="input-group-btn">
                    <button class="btn btn-default" type="submit">Go!</button>
                </span>
            </div>
        </form>
    </div><!-- /input-group -->
    <!--startprint-->
    {% include 'gg.html' %}
    <table class="table table-striped table-bordered table-sm">
        <thead class="thead-dark">
            <tr>
                <th class="p-3 mb-2 bg-danger text-white ">Sales_Order ID</th>
                <th>Customer ID</th>
                <th>Customer Name</th>
                <th>Term</th>
                <th>Start Time</th>
                <th>Finish Time</th>
                <th>Customer Po ID</th>
                <th>Product ID</th>
                <th>Description</th>
                <th>Quantity</th>
                <th>Unit Price</th>
            </tr>
        </thead>
        <tbody>
            {% for sales_order in saless %}
            <tr>
                <td>{{ sales_order.SalesOrderID }}</td>
                <td>{{ sales_order.CustomerID }}</td>
                <td>{{ sales_order.customer_name }}</td>
                <td>{{ sales_order.term }}</td>
                <td>{{ sales_order.start_time }}</td>
                <td>{{ sales_order.finish_time}}</td>
                <td>{{ sales_order.customer_po_id}}</td>
                <td>{{ sales_order.ProductID}}</td>
                <td>{{ sales_order.description}}</td>
                <td>{{ sales_order.quantity}}</td>
                <td>{{ sales_order.unit_price}}</td>
                <td>
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <!----------------------------------------------------------------------------------------------------------->
        <thead class="thead-dark">
            <tr>
                <th class="p-3 mb-2 bg-primary text-white">Project_Sales_Item ID</th>
                <th>Project_Sales_Item Name </th>
                <th>Sales_Order ID</th>
                <th>Customer ID</th>
                <th>Customerpart ID </th>
                <th>Product ID</th>
                <th>Product Name</th>
                <th>Quantity </th>
                <th>Unitprice</th>
                <th>Project_Sales_Item Date</th>
                <th>Term</th>
                <th>Start Time</th>
                <th>Finish Time</th>
                <th>Delivery ID </th>
                <th>Delivery Datetime </th>
            </tr>
        </thead>
        <tbody>
            {% for project_sales_item in project_sales_items %}
            <tr>
                <td>{{ project_sales_item.ProjectSalesItemID }}</td>
                <td>{{ project_sales_item.project_name }}</td>
                <td>{{ project_sales_item.SalesOrderID }}</td>
                <td>{{ project_sales_item.CustomerID }}</td>
                <td>{{ project_sales_item.customerpart_id }}</td>
                <td>{{ project_sales_item.ProductID }}</td>
                <td>{{ project_sales_item.product_name }}</td>
                <td>{{ project_sales_item.quantity }}</td>
                <td>{{ project_sales_item.unitprice }}</td>
                <td>{{ project_sales_item.project_date }}</td>
                <td>{{ project_sales_item.term }}</td>
                <td>{{ project_sales_item.start_time }}</td>
                <td>{{ project_sales_item.finish_time }}</td>
                <td>{{ project_sales_item.DeliveryID }}</td>
                <td>{{ project_sales_item.DeliveryDatetime }}</td>
                <td>
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <!----------------------------------------------------------------------------------------------------------->
        <thead class="thead-dark">
            <tr>
                <th class="p-3 mb-2 bg-info text-white">Product ID</th>
                <th>Product Name</th>
                <th>Product Group</th>
                <th>Product Tooling</th>
                <th>Product Unit ID</th>
                <th>BOM Level</th>
                <th>Date</th>
                <th>Quantity </th>
                <th>Product Type</th>
                <th>Unit Price </th>
                <th>Start Time</th>
                <th>Finish Time</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>{{ product.ProductID }}</td>
                <td>{{ product.product_name }}</td>
                <td>{{ product.product_group }}</td>
                <td>{{ product.product_tooling }}</td>
                <td>{{ product.product_unit }}</td>
                <td>{{ product.BOM_Level }}</td>
                <td>{{ product.date }}</td>
                <td>{{ product.quantity }}</td>
                <td>{{ product.product_type }}</td>
                <td>{{ product.unit_price }}</td>
                <td>{{ product.start_time }}</td>
                <td>{{ product.finish_time }}</td>
                <td>
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <!------------------------------------------------------------------------------>
        <thead class="thead-dark">
            <tr>
                <th class="p-3 mb-2 bg-info text-white">Process ID</th>
                <th>Process Name </th>
                <th>Resource ID</th>
                <th>Project_Sales_Item ID</th>
                <th>Product ID</th>
                <th>Process Tooling</th>
                <th>Start Time</th>
                <th>Finish Time</th>
                <th>Duration</th>
                <th>Quanitiy</th>
                <th>Unit Price</th>
                <th>Cost</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            {% for process in processs %}
            <tr>
                <td>{{ process.ProcessID }}</td>
                <td>{{ process.process_name }}</td>
                <td>{{ process.ResourceID }}</td>
                <td>{{ process.ProjectSalesItemID }}</td>
                <td>{{ process.ProductID }}</td>
                <td>{{ process.process_tooling }}</td>
                <td>{{ process.start_time }}</td>
                <td>{{ process.finish_time }}</td>
                <td>{{ process.duration }}</td>
                <td>{{ process.quanitiy }}</td>
                <td>{{ process.unit_price }}</td>
                <td>{{ process.cost }}</td>
                <td>{{ process.total }}</td>
                <td>
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <!------------------------------------------------------------------------------>
        <thead class="thead-dark">
            <tr>
                <th class="p-3 mb-2 bg-warning text-white">material ID</th>
                <th>Material Name</th>
                <th>Measure Unit</th>
                <th>Tybe</th>
                <th>Form</th>
                <th>Thickness</th>
                <th>Width </th>
                <th>Length</th>
                <th>Pltch</th>
                <th>Default Stock Locatiuon</th>
                <th>Quantity</th>
                <th>Unit Price</th>
            </tr>
        </thead>
        <tbody>
            {% for material in materials %}
            <tr>
                <td>{{ material.MaterialID }}</td>
                <td>{{ material.material_name }}</td>
                <td>{{ material.measure_unit }}</td>
                <td>{{ material.tybe }}</td>
                <td>{{ material.Form}}</td>
                <td>{{ material.thickness}}</td>
                <td>{{ material.usage}}</td>
                <td>{{ material.width }}</td>
                <td>{{ material.length }}</td>
                <td>{{ material.pltch }}</td>
                <td>{{ material.default_stock_locatiuon }}</td>
                <td>{{ material.quantity}}</td>
                <td>{{ material.unit_price}}</td>
                <td>
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <!----------------------------------------------------------------------------------------------------------->
        <thead class="thead-dark">
            <tr>
                <th class="p-3 mb-2 bg-success text-white">RequireID</th>
                <th>BOMID</th>
                <th>ProjectSalesItemID</th>
                <th>ProductID</th>
                <th>MaterialID</th>
                <th>Product Usage</th>
                <th>QTY Project_Sales_Item</th>
                <th>QTY Need</th>
                <th>QTY Stock</th>
                <th>QTY Purchase</th>
                <th>Remarks</th>
                <th>Quantity</th>
            </tr>
        </thead>
        <tbody>
            {% for require in requires %}
            <tr>
                <td>{{ require.RequireID }}</td>
                <td>{{ require.BOMID }}</td>
                <td>{{ require.ProjectSalesItemID }}</td>
                <td>{{ require.ProductID }}</td>
                <td>{{ require.MaterialID }}</td>
                <td>{{ require.product_usage }}</td>
                <td>{{ require.QTY_project }}</td>
                <td>{{ require.QTY_need }}</td>
                <td>{{ require.QTY_stock }}</td>
                <td>{{ require.QTY_purchase }}</td>
                <td>{{ require.remarks }}</td>
                <td>{{ require.quantity}}</td>
                <td>
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <!-------------------------------------------------------------------------------------------------------------------------------->
        <thead class="thead-dark">
            <tr>
                <th class="p-3 mb-2 bg-success text-white">Purchase ID</th>
                <th>Request ID</th>
                <th>Material ID</th>
                <th>Quantity</th>
                <th>Unit Price</th>
                <th>Discount</th>
                <th>Total MYR</th>
                <th>Remarks</th>
                <th>Material Supplier ID</th>
                <th>Deliver Date</th>
            </tr>
        </thead>
        <tbody>
            {% for purchase in purchases %}
            <tr>
                <td>{{ purchase.PurchaseID }}</td>
                <td>{{ purchase.RequireID }}</td>
                <td>{{ purchase.MaterialID}}</td>
                <td>{{ purchase.quantity}}</td>
                <td>{{ purchase.unit_price}}</td>
                <td>{{ purchase.discount}}</td>
                <td>{{ purchase.total_MYR}}</td>
                <td>{{ purchase.remarks}}</td>
                <td>{{ purchase.MaterialSupplierID}}</td>
                <td>{{ purchase.deliver_date }}</td>
                <td>
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <!------------------------------------------------------------------------------>
        <thead class="thead-dark">
            <tr>
                <th class="p-3 mb-2 bg-success text-white">Material Supplier ID </th>
                <th>Supplier ID </th>
                <th>Material ID </th>
                <th>Material Name </th>
                <th>Source</th>
                <th>UOM</th>
                <th>EOQ</th>
                <th>Unit Price </th>
                <th>Term </th>
                <th>Remarks </th>
            </tr>
        </thead>
        <tbody>
            {% for material_supplier in material_suppliers %}
            <tr>
                <td>{{ material_supplier.MaterialSupplierID }}</td>
                <td>{{ material_supplier.SupplierID }}</td>
                <td>{{ material_supplier.MaterialID }}</td>
                <td>{{ material_supplier.material_name }}</td>
                <td>{{ material_supplier.source }}</td>
                <td>{{ material_supplier.UOM }}</td>
                <td>{{ material_supplier.EOQ }}</td>
                <td>{{ material_supplier.unit_price }}</td>
                <td>{{ material_supplier.term }}</td>
                <td>{{ material_supplier.remarks }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table><!--    -->
    <br>
    <br>
    <br>
    <!--endprint-->

    <footer><p id="time"></p><input type="button" class="form-control - btn-dark" value="Print This Page(打印此页面)" onclick="printpage()" /></footer>
    <script>
        function printpage() {
            let oldStr = window.document.body.innerHTML; // 获取body的内容<!-- 可保存成 pdf档案  -->
            let start = "<!--startprint-->"; // 开始打印标识, 17个字符
            let end = "<!--endprint-->"; // 结束打印标识
            let newStr = oldStr.substr(oldStr.indexOf(start) + 17); // 截取开始打印标识之后的内容
            newStr = newStr.substring(0, newStr.indexOf(end)); // 截取开始打印标识和结束打印标识之间的内容
            window.document.body.innerHTML = newStr; // 把需要打印的指定内容赋给body
            window.print(); // 调用浏览器的打印功能打印指定区域
            window.document.body.innerHTML = oldStr; // body替换为原来的内容
        }
    </script>

</body>
</html>
    {% endif %}
